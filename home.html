<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>

<style>
.option > img {
  max-height: 100px
}
.option {
  margin: 10px;
}
nav {
  display: flex;
    justify-content: center;
}
.display {
  position: absolute;
  margin-left: auto;
  margin-right: auto;
  left: 0;
  right: 0;
  max-width: 100%;
  height: 80%;
  margin-top: 10%
}
</style>

<img id='demo' class = 'display' src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
    9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot">

<nav>
  <div class = 'option' id='1' > 
    1
  </div>
  <div class = 'option'id='2'> 
    2
  </div>
  <div class = 'option' id='3'> 
    3
  </div>
</nav>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>
	$(document).ready(function(){
			var currentState = 0

			$(".option").on('click', function(event){
			    event.stopPropagation();
			    event.stopImmediatePropagation();
					var target = event.target
					var id = target.id;
					temp = currentState
					currentState = parseInt(target.innerHTML)
					document.getElementById(id).innerHTML = temp
			});

      var connection = new WebSocket('ws://934800cc.ngrok.io');
      // new WebSocket('ws://10.30.3.126:23456');

      connection.onmessage = function (event) {
          document.getElementById("demo").src = "data:image/png;base64, " + event.data;
      }
      window.onkeydown = function(e) {
          var key = e.keyCode ? e.keyCode : e.which;
          connection.send(String.fromCharCode(key))
      }

      // connection.onopen = function(){}

      $("img").on("click", function(event) {

        var x = event.pageX - this.offsetLeft;
        var y = event.pageY - this.offsetTop;
        // console.log(this.width, x/this.width)
        // console.log(this.height, y/this.height)
        const data = [x/this.width, y/this.height]
        console.log("Client clicks at: ", JSON.stringify(data))
				const full_data = {
					'coords':data,
					'device':currentState
				}
				console.log(JSON.stringify(full_data))
        connection.send(JSON.stringify(data));
        // connection.send(JSON.stringify(full_data))
        connection.onerror = function (error) {
          console.log("an error occurred when sending/receiving data")
          // document.getElementById("background_image").innerHTML = ipad_screenshot.jpg;
        };
       }
     );
  });
</script>
</html>
